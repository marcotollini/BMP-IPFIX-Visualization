{
  "type": "kafka",
  "spec": {
    "ioConfig": {
      "type": "kafka",
      "consumerProperties": {
        "bootstrap.servers": "kafka_broker:29092"
      },
      "topic": "nfacctd_bmp",
      "useEarliestOffset": true,
      "inputFormat": {
        "type": "json",
        "flattenSpec": {
          "fields": [
            {
              "type": "jq",
              "name": "time",
              "expr": "if .timestamp != \"0000-00-00T00:00:00.000000Z\" then .timestamp else .timestamp_arrival end"
            }
          ]
        }
      }
    },
    "tuningConfig": {
      "type": "kafka"
    },
    "dataSchema": {
      "dataSource": "nfacctd_bmp-route_monitor",
      "granularitySpec": {
        "type": "uniform",
        "queryGranularity": "SECOND",
        "segmentGranularity": "HOUR",
        "rollup": true
      },
      "timestampSpec": {
        "column": "time",
        "format": "iso"
      },
      "dimensionsSpec": {
        "dimensions": [
          {
            "name": "seq",
            "type": "long"
          },
          "log_type",
          "timestamp",
          {
            "name": "is_post",
            "type": "long"
          },
          {
            "name": "is_in",
            "type": "long"
          },
          "reason_code",
          "peer_ip",
          {
            "name": "peer_tcp_port",
            "type": "long"
          },
          "event_type",
          {
            "name": "afi",
            "type": "long"
          },
          {
            "name": "safi",
            "type": "long"
          },
          "ip_prefix",
          "bgp_nexthop",
          "as_path",
          "comms",
          "ecomms",
          "origin",
          {
            "name": "local_pref",
            "type": "long"
          },
          "rd",
          "label",
          "timestamp_arrival",
          "bmp_router",
          {
            "name": "bmp_router_port",
            "type": "long"
          },
          "bmp_msg_type",
          "writer_id"
        ]
      },
      "metricsSpec": [],
      "transformSpec": {
        "filter": {
          "type": "selector",
          "dimension": "bmp_msg_type",
          "value": "route_monitor"
        }
      }
    }
  }
}